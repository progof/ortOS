TARGET = ortOS
BUILD_DIR = build
BUILD_APP = ./$(BUILD_DIR)/BigNumberProgram.o ./$(BUILD_DIR)/HelloWorldProgram.o ./$(BUILD_DIR)/MiniProgramController.o
BUILD_CORE = ./$(BUILD_DIR)/core.o 
BUILD_UI = ./$(BUILD_DIR)/ui.o 
CXXFLAGS = -std=c++17
CXX = g++

build_dir:
	if [ ! -d $(BUILD_DIR) ]; then mkdir $(BUILD_DIR); fi

core.o: ./src/core/core.cpp build_dir
	$(CXX) -c ./src/core/core.cpp -o ./$(BUILD_DIR)/core.o

ui.o: ./src/ui/ui.cpp ./src/core/core.cpp build_dir
	$(CXX) -c ./src/ui/ui.cpp -o ./$(BUILD_DIR)/ui.o

BigNumberProgram.o: ./src/programs/BigNumberProgram.cpp ./src/programs/MiniProgramController.hpp ./src/programs/MiniProgram.hpp build_dir
	$(CXX) -c ./src/programs/BigNumberProgram.cpp -o ./$(BUILD_DIR)/BigNumberProgram.o

HelloWorldProgram.o: ./src/programs/HelloWorldProgram.cpp ./src/programs/MiniProgramController.hpp ./src/programs/MiniProgram.hpp build_dir
	$(CXX) -c ./src/programs/HelloWorldProgram.cpp -o ./$(BUILD_DIR)/HelloWorldProgram.o

MiniProgramController.o: ./src/programs/MiniProgramController.cpp ./src/programs/MiniProgramController.hpp ./src/programs/MiniProgram.hpp build_dir
	$(CXX) -c ./src/programs/MiniProgramController.cpp -o ./$(BUILD_DIR)/MiniProgramController.o

run: core.o ui.o BigNumberProgram.o HelloWorldProgram.o MiniProgramController.o ./src/main.hpp build_dir
	g++ $(CXXFLAGS) ./src/main.cpp $(BUILD_APP) $(BUILD_CORE) $(BUILD_UI) $(CXXFLAGS) -o ./$(BUILD_DIR)/$(TARGET) && ./$(BUILD_DIR)/$(TARGET)

clean:
	rm -r ./$(BUILD_DIR)/*